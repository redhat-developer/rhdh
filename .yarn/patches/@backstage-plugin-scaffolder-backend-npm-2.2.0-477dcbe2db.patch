diff --git a/dist/scaffolder/actions/builtin/debug/log.cjs.js b/dist/scaffolder/actions/builtin/debug/log.cjs.js
index debb877e59feae9557b4c112fcb3fedc1ef43128..de033041063a03ec02f68fb1659d7b1c7c87a18d 100644
--- a/dist/scaffolder/actions/builtin/debug/log.cjs.js
+++ b/dist/scaffolder/actions/builtin/debug/log.cjs.js
@@ -1,5 +1,6 @@
 'use strict';
 
+var backendPluginApi = require('@backstage/backend-plugin-api');
 var fs$1 = require('fs-extra');
 var path = require('path');
 var pluginScaffolderNode = require('@backstage/plugin-scaffolder-node');
@@ -37,10 +38,18 @@ function createDebugLogAction() {
 ${files.map((f) => {
             const relativePath = path.relative(ctx.workspacePath, f);
             if (ctx.input?.listWorkspace === "with-contents") {
-              const content = fs__default.default.readFileSync(f, "utf-8");
-              return ` - ${relativePath}:
+              try {
+                const safePath = backendPluginApi.resolveSafeChildPath(
+                  ctx.workspacePath,
+                  relativePath
+                );
+                const content = fs__default.default.readFileSync(safePath, "utf-8");
+                return ` - ${relativePath}:
 
   ${content}`;
+              } catch {
+                return ` - ${relativePath}: [skipped]`;
+              }
             }
             return `  - ${relativePath}`;
           }).join("\n")}`
diff --git a/dist/scaffolder/actions/builtin/debug/log.cjs.js.map b/dist/scaffolder/actions/builtin/debug/log.cjs.js.map
index 3732752f9c45a1459f4dd3e7616dfe191f077d47..d2fc04266c004de38ddfab5a46e69d53327c36cd 100644
--- a/dist/scaffolder/actions/builtin/debug/log.cjs.js.map
+++ b/dist/scaffolder/actions/builtin/debug/log.cjs.js.map
@@ -1 +1 @@
-{"version":3,"file":"log.cjs.js","sources":["../../../../../src/scaffolder/actions/builtin/debug/log.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { readdir, stat } from 'fs-extra';\nimport { join, relative } from 'path';\nimport { createTemplateAction } from '@backstage/plugin-scaffolder-node';\nimport { examples } from './log.examples';\nimport fs from 'fs';\n\nconst id = 'debug:log';\n\n/**\n * Writes a message into the log or lists all files in the workspace\n *\n * @remarks\n *\n * This task is useful for local development and testing of both the scaffolder\n * and scaffolder templates.\n *\n * @public\n */\nexport function createDebugLogAction() {\n  return createTemplateAction({\n    id,\n    description:\n      'Writes a message into the log and/or lists all files in the workspace.',\n    examples,\n    schema: {\n      input: {\n        message: z =>\n          z.string({ description: 'Message to output.' }).optional(),\n        listWorkspace: z =>\n          z\n            .union([z.boolean(), z.enum(['with-filenames', 'with-contents'])], {\n              description:\n                'List all files in the workspace. If used with \"with-contents\", also the file contents are listed.',\n            })\n            .optional(),\n      },\n    },\n    supportsDryRun: true,\n    async handler(ctx) {\n      ctx.logger.info(JSON.stringify(ctx.input, null, 2));\n\n      if (ctx.input?.message) {\n        ctx.logger.info(ctx.input.message);\n      }\n\n      if (ctx.input?.listWorkspace) {\n        const files = await recursiveReadDir(ctx.workspacePath);\n        ctx.logger.info(\n          `Workspace:\\n${files\n            .map(f => {\n              const relativePath = relative(ctx.workspacePath, f);\n              if (ctx.input?.listWorkspace === 'with-contents') {\n                const content = fs.readFileSync(f, 'utf-8');\n                return ` - ${relativePath}:\\n\\n  ${content}`;\n              }\n              return `  - ${relativePath}`;\n            })\n            .join('\\n')}`,\n        );\n      }\n    },\n  });\n}\n\nexport async function recursiveReadDir(dir: string): Promise<string[]> {\n  const subdirs = await readdir(dir);\n  const files = await Promise.all(\n    subdirs.map(async subdir => {\n      const res = join(dir, subdir);\n      return (await stat(res)).isDirectory() ? recursiveReadDir(res) : [res];\n    }),\n  );\n  return files.reduce((a, f) => a.concat(f), []);\n}\n"],"names":["createTemplateAction","examples","relative","fs","readdir","join","stat"],"mappings":";;;;;;;;;;;;AAsBA,MAAM,EAAA,GAAK,WAAA;AAYJ,SAAS,oBAAA,GAAuB;AACrC,EAAA,OAAOA,yCAAA,CAAqB;AAAA,IAC1B,EAAA;AAAA,IACA,WAAA,EACE,wEAAA;AAAA,cACFC,qBAAA;AAAA,IACA,MAAA,EAAQ;AAAA,MACN,KAAA,EAAO;AAAA,QACL,OAAA,EAAS,OACP,CAAA,CAAE,MAAA,CAAO,EAAE,WAAA,EAAa,oBAAA,EAAsB,CAAA,CAAE,QAAA,EAAS;AAAA,QAC3D,aAAA,EAAe,CAAA,CAAA,KACb,CAAA,CACG,KAAA,CAAM,CAAC,CAAA,CAAE,OAAA,EAAQ,EAAG,CAAA,CAAE,KAAK,CAAC,gBAAA,EAAkB,eAAe,CAAC,CAAC,CAAA,EAAG;AAAA,UACjE,WAAA,EACE;AAAA,SACH,EACA,QAAA;AAAS;AAChB,KACF;AAAA,IACA,cAAA,EAAgB,IAAA;AAAA,IAChB,MAAM,QAAQ,GAAA,EAAK;AACjB,MAAA,GAAA,CAAI,MAAA,CAAO,KAAK,IAAA,CAAK,SAAA,CAAU,IAAI,KAAA,EAAO,IAAA,EAAM,CAAC,CAAC,CAAA;AAElD,MAAA,IAAI,GAAA,CAAI,OAAO,OAAA,EAAS;AACtB,QAAA,GAAA,CAAI,MAAA,CAAO,IAAA,CAAK,GAAA,CAAI,KAAA,CAAM,OAAO,CAAA;AAAA,MACnC;AAEA,MAAA,IAAI,GAAA,CAAI,OAAO,aAAA,EAAe;AAC5B,QAAA,MAAM,KAAA,GAAQ,MAAM,gBAAA,CAAiB,GAAA,CAAI,aAAa,CAAA;AACtD,QAAA,GAAA,CAAI,MAAA,CAAO,IAAA;AAAA,UACT,CAAA;AAAA,EAAe,KAAA,CACZ,IAAI,CAAA,CAAA,KAAK;AACR,YAAA,MAAM,YAAA,GAAeC,aAAA,CAAS,GAAA,CAAI,aAAA,EAAe,CAAC,CAAA;AAClD,YAAA,IAAI,GAAA,CAAI,KAAA,EAAO,aAAA,KAAkB,eAAA,EAAiB;AAChD,cAAA,MAAM,OAAA,GAAUC,mBAAA,CAAG,YAAA,CAAa,CAAA,EAAG,OAAO,CAAA;AAC1C,cAAA,OAAO,MAAM,YAAY,CAAA;;AAAA,EAAA,EAAU,OAAO,CAAA,CAAA;AAAA,YAC5C;AACA,YAAA,OAAO,OAAO,YAAY,CAAA,CAAA;AAAA,UAC5B,CAAC,CAAA,CACA,IAAA,CAAK,IAAI,CAAC,CAAA;AAAA,SACf;AAAA,MACF;AAAA,IACF;AAAA,GACD,CAAA;AACH;AAEA,eAAsB,iBAAiB,GAAA,EAAgC;AACrE,EAAA,MAAM,OAAA,GAAU,MAAMC,YAAA,CAAQ,GAAG,CAAA;AACjC,EAAA,MAAM,KAAA,GAAQ,MAAM,OAAA,CAAQ,GAAA;AAAA,IAC1B,OAAA,CAAQ,GAAA,CAAI,OAAM,MAAA,KAAU;AAC1B,MAAA,MAAM,GAAA,GAAMC,SAAA,CAAK,GAAA,EAAK,MAAM,CAAA;AAC5B,MAAA,OAAA,CAAQ,MAAMC,SAAA,CAAK,GAAG,CAAA,EAAG,WAAA,KAAgB,gBAAA,CAAiB,GAAG,CAAA,GAAI,CAAC,GAAG,CAAA;AAAA,IACvE,CAAC;AAAA,GACH;AACA,EAAA,OAAO,KAAA,CAAM,MAAA,CAAO,CAAC,CAAA,EAAG,CAAA,KAAM,EAAE,MAAA,CAAO,CAAC,CAAA,EAAG,EAAE,CAAA;AAC/C;;;;;"}
\ No newline at end of file
+{"version":3,"file":"log.cjs.js","sources":["../../../../../src/scaffolder/actions/builtin/debug/log.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { resolveSafeChildPath } from '@backstage/backend-plugin-api';\nimport { readdir, stat } from 'fs-extra';\nimport { join, relative } from 'path';\nimport { createTemplateAction } from '@backstage/plugin-scaffolder-node';\nimport { examples } from './log.examples';\nimport fs from 'fs';\n\nconst id = 'debug:log';\n\n/**\n * Writes a message into the log or lists all files in the workspace\n *\n * @remarks\n *\n * This task is useful for local development and testing of both the scaffolder\n * and scaffolder templates.\n *\n * @public\n */\nexport function createDebugLogAction() {\n  return createTemplateAction({\n    id,\n    description:\n      'Writes a message into the log and/or lists all files in the workspace.',\n    examples,\n    schema: {\n      input: {\n        message: z =>\n          z.string({ description: 'Message to output.' }).optional(),\n        listWorkspace: z =>\n          z\n            .union([z.boolean(), z.enum(['with-filenames', 'with-contents'])], {\n              description:\n                'List all files in the workspace. If used with \"with-contents\", also the file contents are listed.',\n            })\n            .optional(),\n      },\n    },\n    supportsDryRun: true,\n    async handler(ctx) {\n      ctx.logger.info(JSON.stringify(ctx.input, null, 2));\n\n      if (ctx.input?.message) {\n        ctx.logger.info(ctx.input.message);\n      }\n\n      if (ctx.input?.listWorkspace) {\n        const files = await recursiveReadDir(ctx.workspacePath);\n        ctx.logger.info(\n          `Workspace:\\n${files\n            .map(f => {\n              const relativePath = relative(ctx.workspacePath, f);\n              if (ctx.input?.listWorkspace === 'with-contents') {\n                try {\n                  const safePath = resolveSafeChildPath(\n                    ctx.workspacePath,\n                    relativePath,\n                  );\n                  const content = fs.readFileSync(safePath, 'utf-8');\n                  return ` - ${relativePath}:\\n\\n  ${content}`;\n                } catch {\n                  return ` - ${relativePath}: [skipped]`;\n                }\n              }\n              return `  - ${relativePath}`;\n            })\n            .join('\\n')}`,\n        );\n      }\n    },\n  });\n}\n\nexport async function recursiveReadDir(dir: string): Promise<string[]> {\n  const subdirs = await readdir(dir);\n  const files = await Promise.all(\n    subdirs.map(async subdir => {\n      const res = join(dir, subdir);\n      return (await stat(res)).isDirectory() ? recursiveReadDir(res) : [res];\n    }),\n  );\n  return files.reduce((a, f) => a.concat(f), []);\n}\n"],"names":["createTemplateAction","examples","relative","resolveSafeChildPath","fs","readdir","join","stat"],"mappings":";;;;;;;;;;;;;AAuBA,MAAM,EAAA,GAAK,WAAA;AAYJ,SAAS,oBAAA,GAAuB;AACrC,EAAA,OAAOA,yCAAA,CAAqB;AAAA,IAC1B,EAAA;AAAA,IACA,WAAA,EACE,wEAAA;AAAA,cACFC,qBAAA;AAAA,IACA,MAAA,EAAQ;AAAA,MACN,KAAA,EAAO;AAAA,QACL,OAAA,EAAS,OACP,CAAA,CAAE,MAAA,CAAO,EAAE,WAAA,EAAa,oBAAA,EAAsB,CAAA,CAAE,QAAA,EAAS;AAAA,QAC3D,aAAA,EAAe,CAAA,CAAA,KACb,CAAA,CACG,KAAA,CAAM,CAAC,CAAA,CAAE,OAAA,EAAQ,EAAG,CAAA,CAAE,KAAK,CAAC,gBAAA,EAAkB,eAAe,CAAC,CAAC,CAAA,EAAG;AAAA,UACjE,WAAA,EACE;AAAA,SACH,EACA,QAAA;AAAS;AAChB,KACF;AAAA,IACA,cAAA,EAAgB,IAAA;AAAA,IAChB,MAAM,QAAQ,GAAA,EAAK;AACjB,MAAA,GAAA,CAAI,MAAA,CAAO,KAAK,IAAA,CAAK,SAAA,CAAU,IAAI,KAAA,EAAO,IAAA,EAAM,CAAC,CAAC,CAAA;AAElD,MAAA,IAAI,GAAA,CAAI,OAAO,OAAA,EAAS;AACtB,QAAA,GAAA,CAAI,MAAA,CAAO,IAAA,CAAK,GAAA,CAAI,KAAA,CAAM,OAAO,CAAA;AAAA,MACnC;AAEA,MAAA,IAAI,GAAA,CAAI,OAAO,aAAA,EAAe;AAC5B,QAAA,MAAM,KAAA,GAAQ,MAAM,gBAAA,CAAiB,GAAA,CAAI,aAAa,CAAA;AACtD,QAAA,GAAA,CAAI,MAAA,CAAO,IAAA;AAAA,UACT,CAAA;AAAA,EAAe,KAAA,CACZ,IAAI,CAAA,CAAA,KAAK;AACR,YAAA,MAAM,YAAA,GAAeC,aAAA,CAAS,GAAA,CAAI,aAAA,EAAe,CAAC,CAAA;AAClD,YAAA,IAAI,GAAA,CAAI,KAAA,EAAO,aAAA,KAAkB,eAAA,EAAiB;AAChD,cAAA,IAAI;AACF,gBAAA,MAAM,QAAA,GAAWC,qCAAA;AAAA,kBACf,GAAA,CAAI,aAAA;AAAA,kBACJ;AAAA,iBACF;AACA,gBAAA,MAAM,OAAA,GAAUC,mBAAA,CAAG,YAAA,CAAa,QAAA,EAAU,OAAO,CAAA;AACjD,gBAAA,OAAO,MAAM,YAAY,CAAA;;AAAA,EAAA,EAAU,OAAO,CAAA,CAAA;AAAA,cAC5C,CAAA,CAAA,MAAQ;AACN,gBAAA,OAAO,MAAM,YAAY,CAAA,WAAA,CAAA;AAAA,cAC3B;AAAA,YACF;AACA,YAAA,OAAO,OAAO,YAAY,CAAA,CAAA;AAAA,UAC5B,CAAC,CAAA,CACA,IAAA,CAAK,IAAI,CAAC,CAAA;AAAA,SACf;AAAA,MACF;AAAA,IACF;AAAA,GACD,CAAA;AACH;AAEA,eAAsB,iBAAiB,GAAA,EAAgC;AACrE,EAAA,MAAM,OAAA,GAAU,MAAMC,YAAA,CAAQ,GAAG,CAAA;AACjC,EAAA,MAAM,KAAA,GAAQ,MAAM,OAAA,CAAQ,GAAA;AAAA,IAC1B,OAAA,CAAQ,GAAA,CAAI,OAAM,MAAA,KAAU;AAC1B,MAAA,MAAM,GAAA,GAAMC,SAAA,CAAK,GAAA,EAAK,MAAM,CAAA;AAC5B,MAAA,OAAA,CAAQ,MAAMC,SAAA,CAAK,GAAG,CAAA,EAAG,WAAA,KAAgB,gBAAA,CAAiB,GAAG,CAAA,GAAI,CAAC,GAAG,CAAA;AAAA,IACvE,CAAC;AAAA,GACH;AACA,EAAA,OAAO,KAAA,CAAM,MAAA,CAAO,CAAC,CAAA,EAAG,CAAA,KAAM,EAAE,MAAA,CAAO,CAAC,CAAA,EAAG,EAAE,CAAA;AAC/C;;;;;"}
\ No newline at end of file
diff --git a/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js b/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js
index c02eedfb99e0ba47a00209f36c1c4dd834dd9984..da7121ce9a6eafa8fc57ed99b9c0a32c48306664 100644
--- a/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js
+++ b/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js
@@ -41,10 +41,11 @@ const createFilesystemDeleteAction = () => {
         });
         for (const filepath of resolvedPaths) {
           try {
-            await fs__default.default.remove(filepath);
-            ctx.logger.info(`File ${filepath} deleted successfully`);
+            const safePath = backendPluginApi.resolveSafeChildPath(ctx.workspacePath, filepath);
+            await fs__default.default.remove(safePath);
+            ctx.logger.info(`File ${safePath} deleted successfully`);
           } catch (err) {
-            ctx.logger.error(`Failed to delete file ${filepath}:`, err);
+            ctx.logger.error(`Failed to delete file`, err);
             throw err;
           }
         }
diff --git a/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js.map b/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js.map
index a6cd11449f9e08e3eb4b76d1a85d8e552a2d16e1..060babc8f57cc3c15d7869f78ea4f7b3bb01300a 100644
--- a/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js.map
+++ b/dist/scaffolder/actions/builtin/filesystem/delete.cjs.js.map
@@ -1 +1 @@
-{"version":3,"file":"delete.cjs.js","sources":["../../../../../src/scaffolder/actions/builtin/filesystem/delete.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createTemplateAction } from '@backstage/plugin-scaffolder-node';\nimport { InputError } from '@backstage/errors';\nimport { resolveSafeChildPath } from '@backstage/backend-plugin-api';\nimport fs from 'fs-extra';\nimport globby from 'globby';\nimport { examples } from './delete.examples';\n\n/**\n * Creates new action that enables deletion of files and directories in the workspace.\n * @public\n */\nexport const createFilesystemDeleteAction = () => {\n  return createTemplateAction({\n    id: 'fs:delete',\n    description: 'Deletes files and directories from the workspace',\n    examples,\n    schema: {\n      input: {\n        files: z =>\n          z.array(z.string(), {\n            description: 'A list of files and directories that will be deleted',\n          }),\n      },\n    },\n    supportsDryRun: true,\n    async handler(ctx) {\n      if (!Array.isArray(ctx.input?.files)) {\n        throw new InputError('files must be an Array');\n      }\n\n      for (const file of ctx.input.files) {\n        // globby cannot handle backslash file separators\n        const safeFilepath = resolveSafeChildPath(\n          ctx.workspacePath,\n          file,\n        ).replace(/\\\\/g, '/');\n        const resolvedPaths = await globby(safeFilepath, {\n          cwd: ctx.workspacePath,\n          absolute: true,\n          dot: true,\n        });\n\n        for (const filepath of resolvedPaths) {\n          try {\n            await fs.remove(filepath);\n            ctx.logger.info(`File ${filepath} deleted successfully`);\n          } catch (err) {\n            ctx.logger.error(`Failed to delete file ${filepath}:`, err);\n            throw err;\n          }\n        }\n      }\n    },\n  });\n};\n"],"names":["createTemplateAction","examples","InputError","resolveSafeChildPath","globby","fs"],"mappings":";;;;;;;;;;;;;;AA2BO,MAAM,+BAA+B,MAAM;AAChD,EAAA,OAAOA,yCAAA,CAAqB;AAAA,IAC1B,EAAA,EAAI,WAAA;AAAA,IACJ,WAAA,EAAa,kDAAA;AAAA,cACbC,wBAAA;AAAA,IACA,MAAA,EAAQ;AAAA,MACN,KAAA,EAAO;AAAA,QACL,OAAO,CAAA,CAAA,KACL,CAAA,CAAE,KAAA,CAAM,CAAA,CAAE,QAAO,EAAG;AAAA,UAClB,WAAA,EAAa;AAAA,SACd;AAAA;AACL,KACF;AAAA,IACA,cAAA,EAAgB,IAAA;AAAA,IAChB,MAAM,QAAQ,GAAA,EAAK;AACjB,MAAA,IAAI,CAAC,KAAA,CAAM,OAAA,CAAQ,GAAA,CAAI,KAAA,EAAO,KAAK,CAAA,EAAG;AACpC,QAAA,MAAM,IAAIC,kBAAW,wBAAwB,CAAA;AAAA,MAC/C;AAEA,MAAA,KAAA,MAAW,IAAA,IAAQ,GAAA,CAAI,KAAA,CAAM,KAAA,EAAO;AAElC,QAAA,MAAM,YAAA,GAAeC,qCAAA;AAAA,UACnB,GAAA,CAAI,aAAA;AAAA,UACJ;AAAA,SACF,CAAE,OAAA,CAAQ,KAAA,EAAO,GAAG,CAAA;AACpB,QAAA,MAAM,aAAA,GAAgB,MAAMC,uBAAA,CAAO,YAAA,EAAc;AAAA,UAC/C,KAAK,GAAA,CAAI,aAAA;AAAA,UACT,QAAA,EAAU,IAAA;AAAA,UACV,GAAA,EAAK;AAAA,SACN,CAAA;AAED,QAAA,KAAA,MAAW,YAAY,aAAA,EAAe;AACpC,UAAA,IAAI;AACF,YAAA,MAAMC,mBAAA,CAAG,OAAO,QAAQ,CAAA;AACxB,YAAA,GAAA,CAAI,MAAA,CAAO,IAAA,CAAK,CAAA,KAAA,EAAQ,QAAQ,CAAA,qBAAA,CAAuB,CAAA;AAAA,UACzD,SAAS,GAAA,EAAK;AACZ,YAAA,GAAA,CAAI,MAAA,CAAO,KAAA,CAAM,CAAA,sBAAA,EAAyB,QAAQ,KAAK,GAAG,CAAA;AAC1D,YAAA,MAAM,GAAA;AAAA,UACR;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,GACD,CAAA;AACH;;;;"}
\ No newline at end of file
+{"version":3,"file":"delete.cjs.js","sources":["../../../../../src/scaffolder/actions/builtin/filesystem/delete.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createTemplateAction } from '@backstage/plugin-scaffolder-node';\nimport { InputError } from '@backstage/errors';\nimport { resolveSafeChildPath } from '@backstage/backend-plugin-api';\nimport fs from 'fs-extra';\nimport globby from 'globby';\nimport { examples } from './delete.examples';\n\n/**\n * Creates new action that enables deletion of files and directories in the workspace.\n * @public\n */\nexport const createFilesystemDeleteAction = () => {\n  return createTemplateAction({\n    id: 'fs:delete',\n    description: 'Deletes files and directories from the workspace',\n    examples,\n    schema: {\n      input: {\n        files: z =>\n          z.array(z.string(), {\n            description: 'A list of files and directories that will be deleted',\n          }),\n      },\n    },\n    supportsDryRun: true,\n    async handler(ctx) {\n      if (!Array.isArray(ctx.input?.files)) {\n        throw new InputError('files must be an Array');\n      }\n\n      for (const file of ctx.input.files) {\n        // globby cannot handle backslash file separators\n        const safeFilepath = resolveSafeChildPath(\n          ctx.workspacePath,\n          file,\n        ).replace(/\\\\/g, '/');\n        const resolvedPaths = await globby(safeFilepath, {\n          cwd: ctx.workspacePath,\n          absolute: true,\n          dot: true,\n        });\n\n        for (const filepath of resolvedPaths) {\n          try {\n            const safePath = resolveSafeChildPath(ctx.workspacePath, filepath);\n            await fs.remove(safePath);\n            ctx.logger.info(`File ${safePath} deleted successfully`);\n          } catch (err) {\n            ctx.logger.error(`Failed to delete file`, err);\n            throw err;\n          }\n        }\n      }\n    },\n  });\n};\n"],"names":["createTemplateAction","examples","InputError","resolveSafeChildPath","globby","fs"],"mappings":";;;;;;;;;;;;;;AA2BO,MAAM,+BAA+B,MAAM;AAChD,EAAA,OAAOA,yCAAA,CAAqB;AAAA,IAC1B,EAAA,EAAI,WAAA;AAAA,IACJ,WAAA,EAAa,kDAAA;AAAA,cACbC,wBAAA;AAAA,IACA,MAAA,EAAQ;AAAA,MACN,KAAA,EAAO;AAAA,QACL,OAAO,CAAA,CAAA,KACL,CAAA,CAAE,KAAA,CAAM,CAAA,CAAE,QAAO,EAAG;AAAA,UAClB,WAAA,EAAa;AAAA,SACd;AAAA;AACL,KACF;AAAA,IACA,cAAA,EAAgB,IAAA;AAAA,IAChB,MAAM,QAAQ,GAAA,EAAK;AACjB,MAAA,IAAI,CAAC,KAAA,CAAM,OAAA,CAAQ,GAAA,CAAI,KAAA,EAAO,KAAK,CAAA,EAAG;AACpC,QAAA,MAAM,IAAIC,kBAAW,wBAAwB,CAAA;AAAA,MAC/C;AAEA,MAAA,KAAA,MAAW,IAAA,IAAQ,GAAA,CAAI,KAAA,CAAM,KAAA,EAAO;AAElC,QAAA,MAAM,YAAA,GAAeC,qCAAA;AAAA,UACnB,GAAA,CAAI,aAAA;AAAA,UACJ;AAAA,SACF,CAAE,OAAA,CAAQ,KAAA,EAAO,GAAG,CAAA;AACpB,QAAA,MAAM,aAAA,GAAgB,MAAMC,uBAAA,CAAO,YAAA,EAAc;AAAA,UAC/C,KAAK,GAAA,CAAI,aAAA;AAAA,UACT,QAAA,EAAU,IAAA;AAAA,UACV,GAAA,EAAK;AAAA,SACN,CAAA;AAED,QAAA,KAAA,MAAW,YAAY,aAAA,EAAe;AACpC,UAAA,IAAI;AACF,YAAA,MAAM,QAAA,GAAWD,qCAAA,CAAqB,GAAA,CAAI,aAAA,EAAe,QAAQ,CAAA;AACjE,YAAA,MAAME,mBAAA,CAAG,OAAO,QAAQ,CAAA;AACxB,YAAA,GAAA,CAAI,MAAA,CAAO,IAAA,CAAK,CAAA,KAAA,EAAQ,QAAQ,CAAA,qBAAA,CAAuB,CAAA;AAAA,UACzD,SAAS,GAAA,EAAK;AACZ,YAAA,GAAA,CAAI,MAAA,CAAO,KAAA,CAAM,CAAA,qBAAA,CAAA,EAAyB,GAAG,CAAA;AAC7C,YAAA,MAAM,GAAA;AAAA,UACR;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,GACD,CAAA;AACH;;;;"}
\ No newline at end of file
